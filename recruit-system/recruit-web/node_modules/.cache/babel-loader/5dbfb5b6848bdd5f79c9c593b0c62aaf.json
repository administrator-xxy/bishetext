{"remainingRequest":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\src\\view\\admin\\user\\user-info.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\src\\view\\admin\\user\\user-info.vue","mtime":1656036094000},{"path":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\babel.config.js","mtime":1656036094000},{"path":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1677772052210},{"path":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1677771858682},{"path":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1677772052210},{"path":"C:\\Users\\Hacker\\Desktop\\zhaop\\resume-master\\resume-master\\recruit-system\\recruit-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1677772060461}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"C:\\\\Users\\\\Hacker\\\\Desktop\\\\zhaop\\\\resume-master\\\\resume-master\\\\recruit-system\\\\recruit-web\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Admin from '@/lin/model/admin';\nimport User from '@/lin/model/user';\nexport default {\n  props: {\n    submit: {\n      type: Boolean,\n      // 表单是否显示功能按钮\n      default: true\n    },\n    id: {\n      // 用户id\n      type: Number,\n      default: undefined\n    },\n    groups: {\n      // 所有分组\n      type: Array,\n      default: function _default() {}\n    },\n    labelPosition: {\n      // 表单label位置\n      type: String,\n      default: 'right'\n    },\n    info: {\n      // 用户信息\n      type: Object,\n      default: function _default() {}\n    },\n    pageType: {\n      type: String,\n      default: 'add' // 区分编辑页面/添加页面\n\n    }\n  },\n  inject: ['eventBus'],\n  data: function data() {\n    var _this = this;\n\n    // 验证回调函数\n    var checkUserName = function checkUserName(rule, value, callback) {\n      // eslint-disable-line\n      if (!value) {\n        callback(new Error('用户名不能为空'));\n      }\n\n      callback();\n    };\n\n    var validatePassword = function validatePassword(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else if (value.length < 6) {\n        callback(new Error('密码长度不能少于6位数'));\n      } else {\n        if (_this.form.checkPassword !== '') {\n          _this.$refs.form.validateField('confirm_password');\n        }\n\n        callback();\n      }\n    };\n\n    var validatePassword2 = function validatePassword2(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== _this.form.password) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      loading: false,\n      // 加载动画\n      isEdited: false,\n      // 能否编辑\n      form: {\n        username: '',\n        password: '',\n        tel: '',\n        confirm_password: '',\n        email: '',\n        nickname: '',\n        group_ids: []\n      },\n      // 验证规则\n      rules: {\n        nickname: [{\n          trigger: ['blur', 'change'],\n          required: true\n        }],\n        tel: [{\n          trigger: ['blur', 'change'],\n          required: true\n        }],\n        username: [{\n          validator: checkUserName,\n          trigger: ['blur', 'change'],\n          required: true\n        }],\n        password: [{\n          validator: validatePassword,\n          trigger: 'blur',\n          required: true\n        }],\n        confirm_password: [{\n          validator: validatePassword2,\n          trigger: 'blur',\n          required: true\n        }],\n        email: [{\n          type: 'email',\n          message: '请输入正确的邮箱地址或者不填',\n          trigger: ['blur', 'change']\n        }]\n      }\n    };\n  },\n  methods: {\n    // 提交表单\n    submitForm: function () {\n      var _submitForm = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(formName) {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.$refs[formName].validate( /*#__PURE__*/function () {\n                  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(valid) {\n                    var res;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            if (!valid) {\n                              _context.next = 37;\n                              break;\n                            }\n\n                            if (!(_this2.pageType === 'add')) {\n                              _context.next = 17;\n                              break;\n                            }\n\n                            _context.prev = 2;\n                            _this2.loading = true;\n                            _context.next = 6;\n                            return User.register(_this2.form);\n\n                          case 6:\n                            res = _context.sent;\n\n                            if (res.code < window.MAX_SUCCESS_CODE) {\n                              _this2.loading = false;\n\n                              _this2.$message.success(\"\".concat(res.message));\n\n                              _this2.eventBus.$emit('addUser', true);\n\n                              _this2.resetForm(formName);\n                            }\n\n                            _context.next = 15;\n                            break;\n\n                          case 10:\n                            _context.prev = 10;\n                            _context.t0 = _context[\"catch\"](2);\n                            _this2.loading = false;\n\n                            if (_context.t0.data.code === 10073) {\n                              _this2.$message.error(_context.t0.data.message);\n                            } else {\n                              _this2.$message.error('新增用户失败');\n                            }\n\n                            console.log(_context.t0);\n\n                          case 15:\n                            _context.next = 35;\n                            break;\n\n                          case 17:\n                            if (!(_this2.form.email === _this2.info.email && _this2.form.group_ids.sort().toString() === _this2.info.group_ids.sort().toString())) {\n                              _context.next = 20;\n                              break;\n                            }\n\n                            _this2.$emit('handleInfoResult', false);\n\n                            return _context.abrupt(\"return\");\n\n                          case 20:\n                            _context.prev = 20;\n\n                            if (_this2.form.group_ids.length) {\n                              _context.next = 24;\n                              break;\n                            }\n\n                            _this2.$message.error('至少选择一个角色');\n\n                            return _context.abrupt(\"return\");\n\n                          case 24:\n                            _this2.loading = true;\n                            _context.next = 27;\n                            return Admin.updateOneUser(_this2.form.email, _this2.form.group_ids, _this2.id);\n\n                          case 27:\n                            res = _context.sent;\n                            _context.next = 34;\n                            break;\n\n                          case 30:\n                            _context.prev = 30;\n                            _context.t1 = _context[\"catch\"](20);\n                            _this2.loading = false;\n                            console.log(_context.t1);\n\n                          case 34:\n                            if (res.code < window.MAX_SUCCESS_CODE) {\n                              _this2.loading = false;\n\n                              _this2.$message.success(\"\".concat(res.message));\n\n                              _this2.$emit('handleInfoResult', true);\n                            } else {\n                              _this2.loading = false;\n\n                              _this2.$message.error(\"\".concat(res.message));\n                            }\n\n                          case 35:\n                            _context.next = 39;\n                            break;\n\n                          case 37:\n                            console.log('error submit!!');\n\n                            _this2.$message.error('请填写正确的信息');\n\n                          case 39:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee, null, [[2, 10], [20, 30]]);\n                  }));\n\n                  return function (_x2) {\n                    return _ref.apply(this, arguments);\n                  };\n                }());\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function submitForm(_x) {\n        return _submitForm.apply(this, arguments);\n      }\n\n      return submitForm;\n    }(),\n    // 重置表单\n    resetForm: function resetForm(formName) {\n      if (this.pageType === 'edit') {\n        this.setInfo();\n      } else {\n        this.form.group_ids = [];\n        this.$refs[formName].resetFields();\n      }\n    },\n    setInfo: function setInfo() {\n      this.form.username = this.info.username;\n      this.form.email = this.info.email;\n      this.form.tel = this.info.tel;\n      var temp = [];\n      this.info.group_ids.forEach(function (item) {\n        temp.push(item.id);\n      });\n      this.form.group_ids = temp;\n    }\n  },\n  created: function created() {\n    // 通过是否接收到数据来判断当前页面是添加数据还是编辑数据\n    if (this.pageType === 'edit') {\n      this.setInfo();\n      this.isEdited = true;\n    }\n  }\n};",{"version":3,"mappings":"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","names":["props","submit","type","default","id","groups","labelPosition","info","pageType","inject","data","callback","loading","isEdited","form","username","password","tel","confirm_password","email","nickname","group_ids","rules","trigger","required","validator","message","methods","submitForm","formName","valid","User","res","console","Admin","resetForm","setInfo","temp","created"],"sourceRoot":"src/view/admin/user","sources":["user-info.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <el-form :model=\"form\" status-icon :rules=\"rules\" :label-position=\"labelPosition\" ref=\"form\" label-width=\"100px\"\n      @submit.native.prevent>\n      <el-form-item label=\"用户名\" prop=\"username\">\n        <el-input size=\"medium\" clearable v-model=\"form.username\" :disabled=\"isEdited\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"邮箱\" prop=\"email\">\n        <el-input size=\"medium\" clearable v-model=\"form.email\" :disabled=\"isEdited\" auto-complete=\"new-password\">\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"电话\" prop=\"tel\">\n        <el-input size=\"medium\" clearable v-model=\"form.tel\" :disabled=\"isEdited\" auto-complete=\"new-password\">\n        </el-input>\n      </el-form-item>\n      <el-form-item v-if=\"pageType === 'add'\" label=\"密码\" prop=\"password\">\n        <el-input size=\"medium\" clearable type=\"password\" v-model=\"form.password\" auto-complete=\"new-password\">\n        </el-input>\n      </el-form-item>\n      <el-form-item v-if=\"pageType === 'add'\" label=\"确认密码\" prop=\"confirm_password\" label-position=\"top\">\n        <el-input size=\"medium\" clearable type=\"password\" v-model=\"form.confirm_password\" autocomplete=\"off\"></el-input>\n      </el-form-item>\n      <el-form-item v-if=\"pageType !== 'password'\" label=\"选择角色\">\n        <el-checkbox-group v-model=\"form.group_ids\" size=\"small\" style=\"transform: translateY(5px);\">\n          <el-checkbox v-for=\"item in groups\" :key=\"item.id\" :label=\"item.id\" border style=\"margin-left: 0\">\n            {{\n                item.name\n            }}\n          </el-checkbox>\n        </el-checkbox-group>\n      </el-form-item>\n      <el-form-item v-show=\"submit\" class=\"submit\">\n        <el-button type=\"primary\" :loading=\"loading\" @click=\"submitForm('form')\">保 存</el-button>\n        <el-button @click=\"resetForm('form')\">重 置</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport Admin from '@/lin/model/admin'\nimport User from '@/lin/model/user'\n\nexport default {\n  props: {\n    submit: {\n      type: Boolean, // 表单是否显示功能按钮\n      default: true,\n    },\n    id: {\n      // 用户id\n      type: Number,\n      default: undefined,\n    },\n    groups: {\n      // 所有分组\n      type: Array,\n      default: () => { },\n    },\n    labelPosition: {\n      // 表单label位置\n      type: String,\n      default: 'right',\n    },\n    info: {\n      // 用户信息\n      type: Object,\n      default: () => { },\n    },\n    pageType: {\n      type: String,\n      default: 'add', // 区分编辑页面/添加页面\n    },\n  },\n  inject: ['eventBus'],\n  data() {\n    // 验证回调函数\n    const checkUserName = (rule, value, callback) => {\n      // eslint-disable-line\n      if (!value) {\n        callback(new Error('用户名不能为空'))\n      }\n      callback()\n    }\n    const validatePassword = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码'))\n      } else if (value.length < 6) {\n        callback(new Error('密码长度不能少于6位数'))\n      } else {\n        if (this.form.checkPassword !== '') {\n          this.$refs.form.validateField('confirm_password')\n        }\n        callback()\n      }\n    }\n    const validatePassword2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'))\n      } else if (value !== this.form.password) {\n        callback(new Error('两次输入密码不一致!'))\n      } else {\n        callback()\n      }\n    }\n    return {\n      loading: false, // 加载动画\n      isEdited: false, // 能否编辑\n      form: {\n        username: '',\n        password: '',\n        tel: '',\n        confirm_password: '',\n        email: '',\n        nickname: '',\n        group_ids: [],\n      },\n      // 验证规则\n      rules: {\n        nickname: [\n          {\n            trigger: ['blur', 'change'],\n            required: true,\n          },\n        ],\n        tel: [\n          {\n            trigger: ['blur', 'change'],\n            required: true,\n          },\n        ],\n        username: [\n          {\n            validator: checkUserName,\n            trigger: ['blur', 'change'],\n            required: true,\n          },\n        ],\n        password: [{ validator: validatePassword, trigger: 'blur', required: true }],\n        confirm_password: [{ validator: validatePassword2, trigger: 'blur', required: true }],\n        email: [\n          {\n            type: 'email',\n            message: '请输入正确的邮箱地址或者不填',\n            trigger: ['blur', 'change'],\n          },\n        ],\n      },\n    }\n  },\n  methods: {\n    // 提交表单\n    async submitForm(formName) {\n      this.$refs[formName].validate(async valid => {\n        // eslint-disable-line\n        if (valid) {\n          // 新增用户\n          let res\n          if (this.pageType === 'add') {\n            try {\n              this.loading = true\n              res = await User.register(this.form)\n              if (res.code < window.MAX_SUCCESS_CODE) {\n                this.loading = false\n                this.$message.success(`${res.message}`)\n                this.eventBus.$emit('addUser', true)\n                this.resetForm(formName)\n              }\n            } catch (e) {\n              this.loading = false\n              if (e.data.code === 10073) {\n                this.$message.error(e.data.message)\n              } else {\n                this.$message.error('新增用户失败')\n              }\n              console.log(e)\n            }\n          } else {\n            // 更新用户信息\n            if (\n              this.form.email === this.info.email\n              && this.form.group_ids.sort().toString() === this.info.group_ids.sort().toString()\n            ) {\n              this.$emit('handleInfoResult', false)\n              return\n            }\n            try {\n              if (!this.form.group_ids.length) {\n                this.$message.error('至少选择一个角色')\n                return\n              }\n              this.loading = true\n              res = await Admin.updateOneUser(this.form.email, this.form.group_ids, this.id)\n            } catch (e) {\n              this.loading = false\n              console.log(e)\n            }\n            if (res.code < window.MAX_SUCCESS_CODE) {\n              this.loading = false\n              this.$message.success(`${res.message}`)\n              this.$emit('handleInfoResult', true)\n            } else {\n              this.loading = false\n              this.$message.error(`${res.message}`)\n            }\n          }\n        } else {\n          console.log('error submit!!')\n          this.$message.error('请填写正确的信息')\n        }\n      })\n    },\n    // 重置表单\n    resetForm(formName) {\n      if (this.pageType === 'edit') {\n        this.setInfo()\n      } else {\n        this.form.group_ids = []\n        this.$refs[formName].resetFields()\n      }\n    },\n    setInfo() {\n      this.form.username = this.info.username\n      this.form.email = this.info.email\n      this.form.tel = this.info.tel\n      const temp = []\n      this.info.group_ids.forEach(item => {\n        temp.push(item.id)\n      })\n      this.form.group_ids = temp\n    },\n  },\n  created() {\n    // 通过是否接收到数据来判断当前页面是添加数据还是编辑数据\n    if (this.pageType === 'edit') {\n      this.setInfo()\n      this.isEdited = true\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  margin-top: 20px;\n  margin-left: -5px;\n  max-width: 800px;\n\n  .submit {\n    float: left;\n  }\n}\n</style>\n\n<style lang=\"scss\">\n// .el-radio-group {\n//   &.user-info {\n//     display: flex;\n//     flex-wrap: wrap;\n//     > .el-radio {\n//       width: 150px;\n//       margin-left: 0px !important;\n//       margin-right: 10px;\n//       margin-bottom: 20px;\n//       white-space: normal;\n//       display: flex;\n//     }\n//   }\n// }\n</style>\n"]}]}